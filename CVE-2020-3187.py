import requests
import sys


requests.packages.urllib3.disable_warnings()
def list_urls(file_urls):
    with open(file_urls,'r') as content_file:
        content = content_file.readlines()
        content = [x.strip() for x in content]
        return content

def main(file_urls):
    urls = list_urls(file_urls)
    for url in urls:
        try:
            session = requests.Session()
            url_withpayload = url + "/+CSCOE+/session_password.html"
            response = session.get(url_withpayload,verify=False)
            if response.status_code == 200:
                print(url + '\033[1;31;40m Vulnerable \033[0m')
            else:
                print(url + ' - Not Vulnerable')
        except:
            print(url + ' - URL Parse failed')


if __name__ == '__main__':
    file_urls = sys.argv[1]
    main(file_urls)
